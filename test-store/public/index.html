<!DOCTYPE html>
<html>
<head>
  <title>VE Cart</title>
</head>
<body>
<h1>VE Cart Demo</h1>

<div id="products"></div>

<button onclick="startCheckout()">Checkout</button>

<script>
const products = [
    { name: "Divider", url: "https://portal.veinternational.org/buybuttons/us019814/btn/divider-odi/" },
    { name: "Ice Molds", url: "https://portal.veinternational.org/buybuttons/us019814/btn/ice-molds-oim/" },
    { name: "Shaker Ball", url: "https://portal.veinternational.org/buybuttons/us019814/btn/shaker-ball-osb/" },
    { name: "The Anchor (Snack Compartment)", url: "https://portal.veinternational.org/buybuttons/us019814/btn/the-anchor-snack-compartment-oan/" },
    { name: "Surge IV (Blue Razzberry)", url: "https://portal.veinternational.org/buybuttons/us019814/btn/surge-iv-blue-razzberry-suel1/" },
    { name: "Fall Bundle", url: "https://portal.veinternational.org/buybuttons/us019814/btn/fall-bundle-sef3/" },
    { name: "Peak Protein (Pumpkin Spice)", url: "https://portal.veinternational.org/buybuttons/us019814/btn/peak-protein-pumpkin-spice-supr3/" }
];

const productsDiv = document.getElementById("products");

products.forEach((product, i) => {
    const div = document.createElement("div");
    div.innerHTML = `<strong>${product.name}</strong> <button onclick="addToCart(${i})">Add to Cart</button>`;
    productsDiv.appendChild(div);
});

let cart = [];

function addToCart(index) {
    const item = products[index];
    if (!cart.includes(item)) cart.push(item);
    alert(`${item.name} added to cart`);
}

function startCheckout() {
    if (!cart.length) {
        alert("Cart is empty!");
        return;
    }
    // Pass cart to run.html via query param
    const urls = cart.map(item => encodeURIComponent(item.url)).join(",");
    window.open(`run.html?urls=${urls}`, "_blank", "width=400,height=400");
}
</script>
</body>
</html>
